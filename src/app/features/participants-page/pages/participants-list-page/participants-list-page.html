<div class="flex flex-col gap-3">

@let vm = store;

@if (vm.isLoadingList()) {
<p>Cargando</p>
}
@else {
  <div class="flex flex-row justify-end">
    <p-button
    label="AÃ±adir nuevo participante"
    (onClick)="openDialog(null, CrudPageOption.CREATE)" />
  </div>

  <p-table [value]="vm.participants()" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template ng-template #header>
      <tr>
        <th>No</th>
        <th>Nombre</th>
        <th>Email</th>
        <th>Rol</th>
        <th>Creado</th>
        <th>Opciones</th>
      </tr>
    </ng-template>
    <ng-template #body let-participant let-i="rowIndex">
      <tr>
        <td>{{( i+1) }}</td>
        <td>{{ participant.name }}</td>
        <td>{{ participant.email }}</td>
        <td>{{ participant.jobRole }}</td>
        <td>{{ participant.createdAt }}</td>
        <td>
          <div class="flex flex-row gap-1">
            <a [routerLink]="[participant.id]" size="small" pButton>
              <span>Detalles</span>
            </a>
            <p-button label="actualizar" size="small" (onClick)="openDialog(participant.id, CrudPageOption.UPDATE)" />
            <p-button label="eliminar" size="small" (onClick)="openDialog(participant.id, CrudPageOption.DELETE)"/>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog [visible]="vm.isVisible()" [closable]="false" [modal]="true" [style]="{ width: '55rem' }">

    @switch (vm.option()) {
      @case (CrudPageOption.CREATE) {
        <participant-create/>
      }
      @case (CrudPageOption.UPDATE) {
        <participant-update/>
      }
      @case (CrudPageOption.DELETE) {
        <participant-delete/>
      }
    }
  </p-dialog>
}
<p-toast position="bottom-right"/>
</div>
