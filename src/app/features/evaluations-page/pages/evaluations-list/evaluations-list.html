<div class="flex flex-col gap-3">
  @let vm = store;
  <!-- @if (vm.isLoadingList()) {
  <p>Cargando</p>
  }
  @else { -->
  <div class="flex flex-row justify-end">
    <p-button label="Create" (onClick)="openDialog(null, CrudPageOption.CREATE)" />
  </div>

  <p-table [value]="vm.evaluationsParticipants()" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template ng-template #header>
      <tr>
        <th>no</th>
        <th>participant</th>
        <th>email</th>
        <th>aproved</th>
        <th>createdAt</th>
        <th>options</th>
      </tr>
    </ng-template>
    <ng-template #body let-evaluationParticipant let-i="rowIndex">
      <tr>
        <td>{{( i+1) }}</td>
        <td>{{ evaluationParticipant.participant.name }}</td>
        <td>{{ evaluationParticipant.participant.email }}</td>

        @if (evaluationParticipant.evaluation) {
          <td>{{ evaluationParticipant.evaluation.approved }}</td>
          <td>{{ evaluationParticipant.evaluation.evaluationDate }}</td>
        }
        @else{
          <td>--</td>
          <td>--</td>
        }
        <td>
          <div class="flex flex-row gap-1">

            @if (evaluationParticipant.evaluation) {
              <p-button label="details"
                (onClick)="openDialog(evaluationParticipant.evaluation.id, CrudPageOption.DETAILS)"
              />
              <p-button label="delete" (onClick)="openDialog(evaluationParticipant.evaluation.id, CrudPageOption.DELETE)" />
            }
            <p-button label="evaluar" (onClick)="openDialog(evaluationParticipant.participant.id, CrudPageOption.CREATE)" />

          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>



  <p-dialog [visible]="vm.isVisible()" [closable]="false" [modal]="true" [style]="{ width: '25rem' }">

     @switch (vm.option()) {
      @case (CrudPageOption.DETAILS) {
        <evaluation-details />
      }
      @case (CrudPageOption.CREATE) {
        <evaluation-create />
      }
      @case (CrudPageOption.DELETE) {
        <evaluation-delete />
      }
    }
  </p-dialog>
  <!-- } -->
</div>
